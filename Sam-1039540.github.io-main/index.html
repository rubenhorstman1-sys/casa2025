<!DOCTYPE html>
<html lang="nl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#3B82F6" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Schone Zwaan" />
    <link rel="manifest" href="/manifest.json" />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/icons/icon-192.png"
    />
    <link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192.png" />
    <title>Schone Zwaan</title>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        overscroll-behavior-y: contain;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: scale(0.95);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      .animate-fadeIn {
        animation: fadeIn 0.2s ease-out;
      }
      @keyframes swanBounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-20px);
        }
      }
      .swan-bounce {
        animation: swanBounce 1s ease-in-out infinite;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: scale(0.95);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      .animate-fadeIn {
        animation: fadeIn 0.2s ease-out;
      }
      @keyframes float {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-10px);
        }
      }
      @keyframes wiggle {
        0%,
        100% {
          transform: rotate(-2deg);
        }
        50% {
          transform: rotate(2deg);
        }
      }
      @keyframes glow {
        0%,
        100% {
          box-shadow: 0 0 20px rgba(255, 255, 0, 0.5);
        }
        50% {
          box-shadow: 0 0 40px rgba(255, 255, 0, 0.8);
        }
      }
      .float {
        animation: float 3s ease-in-out infinite;
      }
      .wiggle {
        animation: wiggle 1s ease-in-out infinite;
      }
      .glow {
        animation: glow 2s ease-in-out infinite;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useCallback, useRef } = React;

      // ============================================================================
      // CONFIG
      // ============================================================================

      const firebaseConfigProd = {
        apiKey: "AIzaSyCS17eshv60HQrvqL0AAb7jkm_d0wYUm1Y",
        authDomain: "casa2025-3bd59.firebaseapp.com",
        databaseURL: "https://casa2025-3bd59-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "casa2025-3bd59",
        storageBucket: "casa2025-3bd59.firebasestorage.app",
        messagingSenderId: "960127858391",
        appId: "1:960127858391:web:5f87f541e051e0bc962292",
        measurementId: "G-2BSJPG64YX"
      };

      const isDevelopment =
        window.location.hostname === "localhost" ||
        window.location.hostname === "127.0.0.1" ||
        window.location.hostname === "192.168.0.188";

      const firebaseConfig = isDevelopment
        ? firebaseConfigDev
        : firebaseConfigProd;

      console.log(
        `üî• Firebase Environment: ${
          isDevelopment ? "DEVELOPMENT" : "PRODUCTION"
        }`
      );
      console.log(`üì¶ Project: ${firebaseConfig.projectId}`);

      firebase.initializeApp(firebaseConfig);
      const db = firebase.database();

      const ACTIVITY_LIMIT = 200;
      const MS_PER_DAY = 86400000;

      // ============================================================================
      // ICONS
      // ============================================================================

      const Icon = ({ d, size = 24, className = "" }) => (
        <svg
          width={size}
          height={size}
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          className={className}
        >
          {Array.isArray(d) ? (
            d.map((path, i) => <path key={i} d={path} />)
          ) : (
            <path d={d} />
          )}
        </svg>
      );

      const Icons = {
        Check: (props) => <Icon d="M20 6L9 17l-5-5" {...props} />,
        X: (props) => <Icon d={["M18 6L6 18", "M6 6l12 12"]} {...props} />,
        ChevronLeft: (props) => <Icon d="M15 18l-6-6 6-6" {...props} />,
        ChevronRight: (props) => <Icon d="M9 18l6-6-6-6" {...props} />,
        ChevronDown: (props) => <Icon d="M6 9l6 6 6-6" {...props} />,
        Settings: (props) => (
          <Icon
            d={[
              "M12 15a3 3 0 100-6 3 3 0 000 6z",
              "M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z",
            ]}
            {...props}
          />
        ),
        Trophy: (props) => (
          <Icon
            d={[
              "M6 9H4.5a2.5 2.5 0 010-5H6",
              "M18 9h1.5a2.5 2.5 0 000-5H18",
              "M4 22h16",
              "M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",
              "M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",
              "M18 2H6v7a6 6 0 0012 0V2z",
            ]}
            {...props}
          />
        ),
        Activity: (props) => <Icon d="M22 12h-4l-3 9L9 3l-3 9H2" {...props} />,
        Clock: (props) => (
          <Icon
            d={["M12 22a10 10 0 100-20 10 10 0 000 20z", "M12 6v6l4 2"]}
            {...props}
          />
        ),
        Plus: (props) => <Icon d={["M12 5v14", "M5 12h14"]} {...props} />,
      };

      // ============================================================================
      // UTILITIES
      // ============================================================================

      const getWeekNumber = (date) => {
        const target = new Date(date.valueOf());
        const dayNr = (date.getDay() + 6) % 7;
        target.setDate(target.getDate() - dayNr + 3);
        const jan4 = new Date(target.getFullYear(), 0, 4);
        const dayDiff = (target - jan4) / MS_PER_DAY;
        return 1 + Math.ceil(dayDiff / 7);
      };

      const getWeekDateRange = (weekNum, year) => {
        const jan4 = new Date(year, 0, 4);
        const jan4Day = jan4.getDay() || 7;
        const week1Monday = new Date(jan4);
        week1Monday.setDate(jan4.getDate() - jan4Day + 1);
        const monday = new Date(week1Monday);
        monday.setDate(week1Monday.getDate() + (weekNum - 1) * 7);
        const sunday = new Date(monday);
        sunday.setDate(monday.getDate() + 6);
        return `${monday.getDate()}/${
          monday.getMonth() + 1
        } - ${sunday.getDate()}/${sunday.getMonth() + 1}`;
      };

      const formatTimestamp = (ts) => {
        const date = new Date(ts);
        const diff = Date.now() - ts;
        const mins = Math.floor(diff / 60000);
        const hours = Math.floor(diff / 3600000);
        const days = Math.floor(diff / MS_PER_DAY);
        if (mins < 1) return "Zojuist";
        if (mins < 60) return `${mins} min geleden`;
        if (hours < 24) return `${hours} uur geleden`;
        if (days < 7) return `${days} dag${days !== 1 ? "en" : ""} geleden`;
        return date.toLocaleDateString("nl-NL", {
          day: "numeric",
          month: "short",
        });
      };

      const toast = (msg, type = "error") => {
        const id = `toast-${Date.now()}`;
        const bg =
          type === "error"
            ? "bg-red-500"
            : type === "warning"
            ? "bg-orange-500"
            : "bg-green-500";
        const el = document.createElement("div");
        el.id = id;
        el.className = `fixed bottom-4 right-4 ${bg} text-white px-6 py-3 rounded-lg shadow-lg z-50`;
        el.innerHTML = `<div class="flex items-center gap-3"><span>${msg}</span><button onclick="this.parentElement.parentElement.remove()" class="hover:bg-white hover:bg-opacity-20 rounded p-1">‚úï</button></div>`;
        document.body.appendChild(el);
        setTimeout(() => el.remove(), 5000);
      };

      // ============================================================================
      // COMPONENTS
      // ============================================================================

      const UserPicker = ({ people, onSelect }) => {
        const [showInstallGuide, setShowInstallGuide] = useState(false);

        const isStandalone =
          window.matchMedia("(display-mode: standalone)").matches ||
          window.navigator.standalone;

        return (
          <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
            <div className="max-w-sm w-full space-y-4">
              <div className="bg-white rounded-2xl shadow-2xl p-8">
                <h2 className="text-2xl font-bold text-gray-800 mb-2 text-center">
                  Wie ben jij?
                </h2>
                <p className="text-gray-600 text-center mb-6">
                  Selecteer je naam
                </p>
                <div className="space-y-3">
                  {people.map((name) => (
                    <button
                      key={name}
                      onClick={() => onSelect(name)}
                      className="w-full p-4 rounded-xl border-2 border-gray-200 hover:border-blue-500 hover:bg-blue-50 transition-all font-medium text-gray-700 hover:text-blue-700"
                    >
                      {name}
                    </button>
                  ))}
                </div>
              </div>

              {!isStandalone && (
                <button
                  onClick={() => setShowInstallGuide(true)}
                  className="w-full bg-blue-500 hover:bg-blue-600 text-white p-4 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2"
                >
                  <span className="text-xl">üì±</span>
                  <span className="font-medium">
                    Installeer app op beginscherm
                  </span>
                </button>
              )}

              {/* Install Guide Modal */}
              {showInstallGuide && (
                <>
                  <div
                    className="fixed inset-0 bg-black bg-opacity-50 z-40"
                    onClick={() => setShowInstallGuide(false)}
                  />
                  <div className="fixed inset-0 flex items-center justify-center p-4 z-50">
                    <div className="bg-white rounded-2xl shadow-2xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto animate-fadeIn">
                      <div className="flex justify-between items-start mb-4">
                        <h2 className="text-xl font-bold text-gray-800">
                          Installeer op beginscherm
                        </h2>
                        <button
                          onClick={() => setShowInstallGuide(false)}
                          className="p-1 hover:bg-gray-100 rounded-lg transition-colors"
                        >
                          <Icons.X size={20} />
                        </button>
                      </div>

                      <div className="space-y-4">
                        <div className="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                          <p className="text-sm text-blue-800 font-medium mb-1">
                            iOS Safari instructies:
                          </p>
                          <ol className="text-sm text-blue-700 space-y-2 list-decimal list-inside">
                            <li>
                              Tik op het <strong>"Deel"</strong> icoontje
                              onderaan (vierkant met pijl omhoog)
                            </li>
                            <li>
                              Scroll naar beneden en kies{" "}
                              <strong>"Zet op beginscherm"</strong>
                            </li>
                            <li>
                              Tik op <strong>"Voeg toe"</strong>
                            </li>
                          </ol>
                        </div>

                        <div className="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                          <p className="text-sm text-green-800 font-medium mb-1">
                            Android Chrome instructies:
                          </p>
                          <ol className="text-sm text-green-700 space-y-2 list-decimal list-inside">
                            <li>
                              Tik op het <strong>menu</strong> icoontje (3
                              puntjes rechtsboven)
                            </li>
                            <li>
                              Selecteer{" "}
                              <strong>"Toevoegen aan startscherm"</strong>
                            </li>
                            <li>
                              Tik op <strong>"Toevoegen"</strong>
                            </li>
                          </ol>
                        </div>

                        <div className="text-center pt-2">
                          <button
                            onClick={() => setShowInstallGuide(false)}
                            className="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 p-3 rounded-xl font-medium transition-colors"
                          >
                            Begrepen
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </>
              )}
            </div>
          </div>
        );
      };

      const ConfirmDialog = ({
        isOpen,
        title,
        message,
        onConfirm,
        onCancel,
        confirmText = "Bevestig",
        cancelText = "Annuleer",
      }) => {
        if (!isOpen) return null;
        return (
          <>
            <div
              className="fixed inset-0 bg-black bg-opacity-50 z-40"
              onClick={onCancel}
            />
            <div className="fixed inset-0 flex items-center justify-center p-4 z-50">
              <div className="bg-white rounded-2xl shadow-2xl p-6 max-w-sm w-full animate-fadeIn">
                <h3 className="text-xl font-bold text-gray-800 mb-2">
                  {title}
                </h3>
                <p className="text-gray-600 mb-6">{message}</p>
                <div className="flex gap-3">
                  <button
                    onClick={onCancel}
                    className="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 p-3 rounded-xl font-medium transition-colors"
                  >
                    {cancelText}
                  </button>
                  <button
                    onClick={onConfirm}
                    className="flex-1 bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-xl font-medium transition-colors"
                  >
                    {confirmText}
                  </button>
                </div>
              </div>
            </div>
          </>
        );
      };

      // ============================================================================
      // PANDA LOADING SCREEN
      // ============================================================================

      function PandaLoadingScreen() {
        const [progress, setProgress] = useState(0);

        useEffect(() => {
          const startTime = Date.now();
          const duration = 2000; // 2 seconds to reach 100%

          const interval = setInterval(() => {
            const elapsed = Date.now() - startTime;
            const newProgress = Math.min((elapsed / duration) * 100, 100);
            setProgress(newProgress);

            if (newProgress >= 100) {
              clearInterval(interval);
            }
          }, 50);

          return () => clearInterval(interval);
        }, []);

        return (
          <div className="min-h-screen bg-gradient-to-br from-yellow-300 via-pink-400 to-purple-500 flex items-center justify-center p-4">
            <div
              className="bg-gradient-to-br from-yellow-300 via-pink-400 to-purple-500 rounded-2xl p-8 flex flex-col items-center justify-center border-4 border-black max-w-sm w-full"
              style={{ boxShadow: "8px 8px 0 black" }}
            >
              <div className="bg-red-600 text-white px-6 py-2 rounded-full text-xs font-black mb-4 border-2 border-black animate-pulse">
                üîí CLASSIFIED üîí
              </div>
              <div className="text-7xl mb-3">üêº</div>
              <h2 className="text-xl font-black text-black mb-4">
                ACCESSING PANDA DATABASE...
              </h2>
              <div className="w-full max-w-xs">
                <div className="bg-white/30 rounded-full h-4 overflow-hidden border-2 border-black mb-2">
                  <div
                    className="bg-white h-full transition-all duration-300 rounded-full"
                    style={{ width: `${progress}%` }}
                  />
                </div>
                <div
                  className="flex justify-between text-xs font-black text-white"
                  style={{ textShadow: "1px 1px 0 black" }}
                >
                  <span>LOADING...</span>
                  <span>{Math.floor(progress)}%</span>
                </div>
              </div>
            </div>
          </div>
        );
      }

      // ============================================================================
      // PANDA POINTS VIEW
      // ============================================================================

      function PandaPointsView({ user, people, onBack }) {
        const [pandaPeople, setPandaPeople] = useState([]);
        const [loading, setLoading] = useState(true);

        const randomPhrases = [
          "gelangd",
          "gewiept",
          "gescoord",
          "een nummertje gemaakt",
          "geneukt",
          "genaaid",
          "gebeukt",
          "gepompt",
          "geknald",
          "gebonkt",
          "geramd",
          "gelegen",
          "gevrijd",
          "seks gehad",
          "de lakens gedeeld",
          "het bed ingedoken",
          "de liefde bedreven",
          "ketsen",
          "gekieteld",
          "lakens verscheurd",
          "ondergespoten",
          "ontmaagd",
          "stijn nagedaan",
          "rubber gevuld",
          "gepakt",
          "gehamerd",
          "gestoten",
          "gebaft",
          "gebeest",
          "horizontale tango gedaan",
          "op bezoek geweest",
          "de bloemetjes buitengezet",
          "genomen",
          "geplakt",
          "de was gedaan",
          "gepord",
          "de koffer ingepakt",
        ];

        const getRandomPhrase = () => {
          return randomPhrases[
            Math.floor(Math.random() * randomPhrases.length)
          ];
        };

        const [randomPhrase, setRandomPhrase] = useState(getRandomPhrase());

        useEffect(() => {
          const ref = db.ref("pandaPoints");
          ref.on("value", (snap) => {
            const data = snap.val();
            if (data) {
              setPandaPeople(data);
            } else {
              // Initialize
              const initial = people.map((name) => ({
                name,
                lastReset: Date.now(),
                avatar: "üêº",
              }));
              ref.set(initial);
              setPandaPeople(initial);
            }
            setLoading(false);
          });
          return () => ref.off();
        }, [people]);

        const calculatePoints = (lastResetTimestamp) => {
          return Math.floor(
            (Date.now() - lastResetTimestamp) / (7 * 24 * 60 * 60 * 1000)
          );
        };

        const calculateTimeUntilNextPoint = (lastResetTimestamp) => {
          const now = Date.now();
          const weeksSince = Math.floor(
            (now - lastResetTimestamp) / (7 * 24 * 60 * 60 * 1000)
          );
          const nextPointTime =
            lastResetTimestamp + (weeksSince + 1) * 7 * 24 * 60 * 60 * 1000;
          const timeLeft = nextPointTime - now;
          const days = Math.floor(timeLeft / (24 * 60 * 60 * 1000));
          const hours = Math.floor(
            (timeLeft % (24 * 60 * 60 * 1000)) / (60 * 60 * 1000)
          );
          const minutes = Math.floor(
            (timeLeft % (60 * 60 * 1000)) / (60 * 1000)
          );
          const weekMs = 7 * 24 * 60 * 60 * 1000;
          const timeSinceLastPoint =
            now - (lastResetTimestamp + weeksSince * weekMs);
          const progressPercent = (timeSinceLastPoint / weekMs) * 100;
          return { days, hours, minutes, progressPercent };
        };

        const getAchievement = (points) => {
          if (points === 0)
            return {
              title: "PANDA KING",
              emoji: "üëë",
              color: "text-green-700",
            };
          if (points <= 2)
            return { title: "BABY PANDA", emoji: "üçº", color: "text-blue-600" };
          if (points <= 5)
            return { title: "PANDA", emoji: "üêº", color: "text-gray-700" };
          if (points <= 9)
            return {
              title: "VETERAN PANDA",
              emoji: "üéñÔ∏è",
              color: "text-orange-600",
            };
          if (points <= 14)
            return {
              title: "PANDA MASTER",
              emoji: "ü•ã",
              color: "text-purple-600",
            };
          return { title: "ANCIENT PANDA", emoji: "üë¥", color: "text-red-700" };
        };

        const handleReset = async (personName) => {
          const updated = pandaPeople.map((p) =>
            p.name === personName ? { ...p, lastReset: Date.now() } : p
          );
          await db.ref("pandaPoints").set(updated);
          setRandomPhrase(getRandomPhrase());
        };

        const sortedPeople = [...pandaPeople].sort((a, b) => {
          const pointsA = calculatePoints(a.lastReset);
          const pointsB = calculatePoints(b.lastReset);
          return pointsB - pointsA;
        });

        if (loading) {
          return (
            <div className="min-h-screen bg-gradient-to-br from-purple-600 via-pink-500 to-red-500 flex items-center justify-center">
              <div className="text-6xl float">üêº</div>
            </div>
          );
        }

        return (
          <div className="min-h-screen bg-gradient-to-br from-purple-600 via-pink-500 to-red-500 p-4">
            <div className="max-w-md mx-auto">
              <div
                className="bg-gradient-to-r from-yellow-300 to-orange-400 rounded-2xl shadow-lg p-3 mb-4 border-3 border-black"
                style={{ boxShadow: "4px 4px 0 black" }}
              >
                <div className="flex items-center justify-between">
                  <div className="flex items-center gap-2">
                    <button
                      onClick={onBack}
                      className="p-2 hover:bg-white hover:bg-opacity-20 rounded-lg"
                    >
                      <Icons.ChevronLeft size={20} />
                    </button>
                    <div className="w-10 h-10 rounded-full bg-purple-600 text-white flex items-center justify-center font-black text-lg border-2 border-black">
                      {user.charAt(0)}
                    </div>
                    <span className="text-sm font-black text-purple-900">
                      AGENT: <span className="text-black">{user}</span>
                    </span>
                  </div>
                </div>
              </div>

              <div
                className="bg-gradient-to-br from-yellow-300 via-pink-400 to-purple-500 rounded-3xl p-6 shadow-2xl border-4 border-black glow"
                style={{ boxShadow: "8px 8px 0 black" }}
              >
                <div className="text-center mb-6">
                  <div className="text-6xl mb-3 float">üêº</div>
                  <h2
                    className="text-3xl font-black text-white mb-1"
                    style={{ textShadow: "3px 3px 0 black" }}
                  >
                    PANDA PUNTEN
                  </h2>
                  <p className="text-yellow-200 font-black text-sm">
                    üîí CLASSIFIED INFO üîí
                  </p>
                </div>

                <div className="grid grid-cols-1 gap-4">
                  {sortedPeople.map((person, index) => {
                    const points = calculatePoints(person.lastReset);
                    const isHuisPanda = index === 0 && points > 0;
                    const isBest = points === 0;
                    const achievement = getAchievement(points);
                    const timeUntilNext = calculateTimeUntilNextPoint(
                      person.lastReset
                    );

                    return (
                      <div
                        key={person.name}
                        className={`rounded-2xl p-5 border-3 border-black transform transition-all hover:scale-105 ${
                          isHuisPanda
                            ? "bg-gradient-to-r from-red-400 to-orange-500 wiggle"
                            : isBest
                            ? "bg-gradient-to-r from-green-300 to-emerald-400"
                            : "bg-white"
                        }`}
                        style={{ boxShadow: "4px 4px 0 black" }}
                      >
                        <div className="flex items-start justify-between mb-3">
                          <div className="flex items-center gap-3">
                            <div className="text-5xl">{person.avatar}</div>
                            <div>
                              <div className="font-black text-xl">
                                {person.name}
                              </div>
                              <div
                                className={`text-sm font-black mt-1 ${achievement.color}`}
                              >
                                {achievement.emoji} {achievement.title}
                              </div>
                            </div>
                          </div>
                          <div className="text-right">
                            <div
                              className={`text-4xl font-black ${
                                isBest
                                  ? "text-green-700"
                                  : isHuisPanda
                                  ? "text-red-900"
                                  : "text-orange-700"
                              }`}
                              style={{
                                textShadow: "2px 2px 0 rgba(255,255,255,0.3)",
                              }}
                            >
                              {points}
                            </div>
                            <div className="text-xs font-bold opacity-75">
                              PTS
                            </div>
                          </div>
                        </div>

                        <div className="mt-3">
                          <div className="flex justify-between text-xs font-bold text-gray-600 mb-1">
                            <span>Next +1pt</span>
                            <span>
                              {timeUntilNext.days}d {timeUntilNext.hours}h
                            </span>
                          </div>
                          <div className="w-full bg-gray-200 rounded-full h-2 border border-gray-400">
                            <div
                              className="bg-orange-500 h-full rounded-full transition-all"
                              style={{
                                width: `${timeUntilNext.progressPercent}%`,
                              }}
                            />
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>

                <button
                  onClick={() => handleReset(user)}
                  className="w-full mt-6 bg-gradient-to-r from-yellow-300 via-pink-400 to-purple-500 text-white p-5 rounded-2xl font-black text-xl shadow-lg transition-all border-4 border-black transform hover:scale-105 active:scale-95"
                  style={{
                    textShadow: "2px 2px 0 black",
                    boxShadow: "5px 5px 0 black",
                  }}
                >
                  {randomPhrase.toUpperCase()}!!!
                </button>
              </div>
            </div>
          </div>
        );
      }

      // ============================================================================
      // MAIN APP
      // ============================================================================

      function App() {
        const [user, setUser] = useState(
          localStorage.getItem("currentUser") || ""
        );
        const [view, setView] = useState("tracker");

        // Firebase state
        const [config, setConfig] = useState(null);
        const [currentTasks, setCurrentTasks] = useState({});
        const [lastTasks, setLastTasks] = useState({});
        const [leaderboard, setLeaderboard] = useState({});
        const [dishwasherLogs, setDishwasherLogs] = useState([]);
        const [activity, setActivity] = useState([]);

        // UI state
        const [showDishwasherConfirm, setShowDishwasherConfirm] =
          useState(false);
        const [loading, setLoading] = useState(true);
        const [loadingPandaZone, setLoadingPandaZone] = useState(false);

        // Pull-to-refresh state
        const [pullDistance, setPullDistance] = useState(0);
        const [isRefreshing, setIsRefreshing] = useState(false);
        const touchStartY = useRef(0);

        // Make date/week reactive - update every minute to catch week transitions
        const [now, setNow] = useState(new Date());
        const currentWeek = getWeekNumber(now);
        const currentYear = now.getFullYear();

        // Update current time every minute to catch week transitions
        useEffect(() => {
          const interval = setInterval(() => {
            setNow(new Date());
          }, 60000); // Check every minute

          return () => clearInterval(interval);
        }, []);

        // ============================================================================
        // FIREBASE SYNC
        // ============================================================================

        useEffect(() => {
          const refs = {
            config: db.ref("config"),
            currentTasks: db.ref("currentWeekTasks"),
            lastTasks: db.ref("lastWeekTasks"),
            leaderboard: db.ref("leaderboard"),
            dishwasher: db.ref("dishwasherLogs"),
            activity: db.ref("activity"),
          };

          refs.config.on("value", (snap) => {
            const data = snap.val();
            if (data) {
              // Ensure all required fields exist
              setConfig({
                currentWeek: data.currentWeek || currentWeek,
                lastWeek: data.lastWeek || null,
                people: data.people || [],
                tasks: data.tasks || [],
                rotationOffsets: data.rotationOffsets || {},
                dishwasherPoints: data.dishwasherPoints || 0.25,
              });
            } else {
              // Initialize default config if nothing exists
              const defaultConfig = {
                currentWeek: currentWeek,
                lastWeek: null,
                people: ["Sam", "Roel", "Stijn", "Tom", "Maxim"],
                tasks: [
                  {
                    id: "woonkamer",
                    name: "Woonkamer",
                    assignedPeople: ["Roel", "Stijn"],
                    points: 1.0,
                  },
                  {
                    id: "keuken",
                    name: "Keuken",
                    assignedPeople: ["Tom", "Maxim"],
                    points: 1.0,
                  },
                  {
                    id: "vuilnis",
                    name: "Doeken/Vuilnis",
                    assignedPeople: ["Sam"],
                    points: 1.0,
                  },
                ],
                rotationOffsets: {},
                dishwasherPoints: 0.25,
              };
              setConfig(defaultConfig);
              db.ref("config").set(defaultConfig);
            }
          });

          refs.currentTasks.on("value", (snap) =>
            setCurrentTasks(snap.val() || {})
          );
          refs.lastTasks.on("value", (snap) => setLastTasks(snap.val() || {}));
          refs.leaderboard.on("value", (snap) =>
            setLeaderboard(snap.val() || {})
          );
          refs.dishwasher.on("value", (snap) =>
            setDishwasherLogs(snap.val() || [])
          );
          refs.activity.on("value", (snap) => setActivity(snap.val() || []));

          setLoading(false);

          return () => Object.values(refs).forEach((ref) => ref.off());
        }, []);

        // ============================================================================
        // WEEK TRANSITION LOGIC
        // ============================================================================

        const isTransitioning = useRef(false);

        useEffect(() => {
          console.log("‚è∞ Week check:", {
            hasConfig: !!config,
            loading,
            isTransitioning: isTransitioning.current,
            configWeek: config?.currentWeek,
            actualWeek: currentWeek,
            needsTransition: config ? config.currentWeek < currentWeek : false,
          });

          if (!config || loading || isTransitioning.current) return;

          const needsTransition = config.currentWeek < currentWeek;

          if (needsTransition) {
            console.log("üîÑ Week transition detected", {
              from: config.currentWeek,
              to: currentWeek,
            });
            isTransitioning.current = true;
            handleWeekTransition();
          }
        }, [config, currentWeek, loading]);

        const handleWeekTransition = async () => {
          try {
            console.log("üîÑ Starting week transition...");
            console.log(
              "Current leaderboard (will be preserved):",
              leaderboard
            );

            // NOTE: Leaderboard is NOT modified during transition!
            // All points (tasks + dishwasher) are already added in real-time when they happen.
            // Week transition only needs to:
            // 1. Move current tasks to last week
            // 2. Clear current tasks for new week
            // 3. Update week numbers

            // 1. Move current tasks to last week
            console.log("üì¶ Moving current tasks to last week:", currentTasks);
            await db.ref("lastWeekTasks").set(currentTasks);

            // 2. Clear current tasks - explicitly set ALL to false
            const emptyTasks = {};
            config.tasks.forEach((task) => {
              emptyTasks[task.id] = false;
            });
            console.log("üßπ Clearing current tasks, setting to:", emptyTasks);
            await db.ref("currentWeekTasks").set(emptyTasks);

            // 3. Update config with new week numbers
            await db.ref("config").update({
              currentWeek: currentWeek,
              lastWeek: config.currentWeek,
            });

            // 4. Log activity
            logActivity(
              "systeem",
              "week automatisch overgegaan",
              `Week ${config.currentWeek} ‚Üí ${currentWeek}`,
              true
            );

            console.log("‚úÖ Week transition complete - leaderboard preserved");
            isTransitioning.current = false;
          } catch (error) {
            console.error("‚ùå Week transition error:", error);
            toast("Fout bij week overgang");
            isTransitioning.current = false;
          }
        };

        // ============================================================================
        // PULL-TO-REFRESH
        // ============================================================================

        useEffect(() => {
          let startY = 0;

          const handleTouchStart = (e) => {
            if (window.scrollY === 0) {
              startY = e.touches[0].clientY;
              touchStartY.current = startY;
            }
          };

          const handleTouchMove = (e) => {
            if (window.scrollY === 0 && touchStartY.current > 0) {
              const currentY = e.touches[0].clientY;
              const distance = currentY - touchStartY.current;

              if (distance > 0 && distance < 150) {
                e.preventDefault();
                setPullDistance(distance);
              }
            }
          };

          const handleTouchEnd = async () => {
            if (pullDistance > 80) {
              setIsRefreshing(true);
              // Reload the page or refetch Firebase data
              await new Promise((resolve) => setTimeout(resolve, 1000));
              window.location.reload();
            }
            setPullDistance(0);
            touchStartY.current = 0;
          };

          document.addEventListener("touchstart", handleTouchStart, {
            passive: true,
          });
          document.addEventListener("touchmove", handleTouchMove, {
            passive: false,
          });
          document.addEventListener("touchend", handleTouchEnd);

          return () => {
            document.removeEventListener("touchstart", handleTouchStart);
            document.removeEventListener("touchmove", handleTouchMove);
            document.removeEventListener("touchend", handleTouchEnd);
          };
        }, [pullDistance]);

        // ============================================================================
        // HELPER FUNCTIONS
        // ============================================================================

        const getAssignment = (task, week) => {
          if (!task || !task.assignedPeople) return null;
          const assigned = task.assignedPeople;
          if (assigned.length === 0) return null;
          if (assigned.length === 1) return assigned[0];
          const offset = config.rotationOffsets?.[task.id] || 0;
          const index = (week - 1 + offset) % assigned.length;
          return assigned[index];
        };

        const logActivity = async (user, action, task, status) => {
          const newActivity = [
            {
              user,
              action,
              task,
              status,
              timestamp: Date.now(),
              weekNumber: config.currentWeek,
            },
            ...activity,
          ].slice(0, ACTIVITY_LIMIT);
          await db.ref("activity").set(newActivity);
        };

        const toggleTask = async (taskId, isLastWeek = false) => {
          const tasks = isLastWeek ? lastTasks : currentTasks;
          const newStatus = !tasks[taskId];
          const newTasks = { ...tasks, [taskId]: newStatus };

          const ref = isLastWeek ? "lastWeekTasks" : "currentWeekTasks";
          await db.ref(ref).set(newTasks);

          const task = config.tasks.find((t) => t.id === taskId);
          const taskName = task?.name || taskId;

          // Handle late completion
          if (isLastWeek && newStatus) {
            const assignment = getAssignment(task, config.lastWeek);
            if (assignment && leaderboard[assignment]) {
              const latePoints = (task.points || 1.0) * 0.5;
              await db.ref(`leaderboard/${assignment}`).update({
                latePoints:
                  (leaderboard[assignment].latePoints || 0) + latePoints,
                totalPoints: leaderboard[assignment].totalPoints + latePoints,
              });
            }
            logActivity(user, "afgevinkt (te laat)", taskName, true);
          } else {
            // REAL-TIME LEADERBOARD UPDATE for current week tasks
            if (!isLastWeek) {
              const assignment = getAssignment(task, config.currentWeek);
              if (assignment) {
                const newLeaderboard = { ...leaderboard };
                if (!newLeaderboard[assignment]) {
                  newLeaderboard[assignment] = {
                    totalPoints: 0,
                    onTimePoints: 0,
                    latePoints: 0,
                    dishwasherPoints: 0,
                    dishwasherCount: 0,
                  };
                }

                const pointChange = (task.points || 1.0) * (newStatus ? 1 : -1);
                newLeaderboard[assignment].onTimePoints += pointChange;
                newLeaderboard[assignment].totalPoints += pointChange;

                await db.ref("leaderboard").set(newLeaderboard);
              }
            }

            logActivity(
              user,
              newStatus ? "afgevinkt" : "uitgevinkt",
              taskName,
              newStatus
            );
          }
        };

        const canEmptyDishwasher = () => {
          const today = now.toDateString();
          return !dishwasherLogs.some(
            (log) =>
              new Date(log.timestamp).toDateString() === today &&
              log.weekNumber === config.currentWeek
          );
        };

        const confirmDishwasher = async () => {
          const newLog = {
            user,
            timestamp: now.getTime(),
            weekNumber: config.currentWeek,
            points: config.dishwasherPoints || 0.25,
          };

          // Add to logs
          await db.ref("dishwasherLogs").set([...dishwasherLogs, newLog]);

          // Update leaderboard immediately
          const newLeaderboard = { ...leaderboard };
          if (!newLeaderboard[user]) {
            newLeaderboard[user] = {
              totalPoints: 0,
              onTimePoints: 0,
              latePoints: 0,
              dishwasherPoints: 0,
              dishwasherCount: 0,
            };
          }

          newLeaderboard[user].dishwasherPoints += config.dishwasherPoints;
          newLeaderboard[user].totalPoints += config.dishwasherPoints;
          newLeaderboard[user].dishwasherCount =
            dishwasherLogs.filter((log) => log.user === user).length + 1;

          await db.ref("leaderboard").set(newLeaderboard);

          logActivity(
            user,
            "leegde vaatwasser",
            `+${config.dishwasherPoints} punten`,
            true
          );
          setShowDishwasherConfirm(false);
        };

        // ============================================================================
        // RENDER
        // ============================================================================

        if (!user && config) {
          return (
            <UserPicker
              people={config.people}
              onSelect={(name) => {
                setUser(name);
                localStorage.setItem("currentUser", name);
              }}
            />
          );
        }

        if (loading || !config) {
          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center">
              <div className="text-center">
                <div className="text-4xl mb-4">ü¶¢</div>
                <div className="text-gray-600">Laden...</div>
              </div>
            </div>
          );
        }

        const viewingLastWeek = view === "lastWeek";
        const tasks = viewingLastWeek ? lastTasks : currentTasks;
        const weekNumber = viewingLastWeek
          ? config.lastWeek
          : config.currentWeek;
        const isEditable =
          !viewingLastWeek || currentWeek - config.lastWeek <= 1;

        const completedCount =
          Object.values(currentTasks).filter(Boolean).length;
        const totalTasks = config.tasks.length;

        // Show loading screen when accessing Panda Zone
        if (loadingPandaZone) {
          return <PandaLoadingScreen />;
        }

        // Show Panda Points view
        if (view === "pandaPoints") {
          return (
            <PandaPointsView
              user={user}
              people={config.people}
              onBack={() => {
                setLoadingPandaZone(false);
                setView("tracker");
              }}
            />
          );
        }

        return (
          <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 pb-8">
            <div className="max-w-md mx-auto">
              {/* Pull to Refresh Indicator */}
              {pullDistance > 0 && (
                <div
                  className="fixed top-0 left-0 right-0 flex justify-center items-center transition-opacity z-50"
                  style={{
                    height: `${Math.min(pullDistance, 80)}px`,
                    opacity: pullDistance / 100,
                  }}
                >
                  <div className="bg-white rounded-full p-3 shadow-lg">
                    {isRefreshing ? (
                      <div className="animate-spin text-blue-500">‚Üª</div>
                    ) : (
                      <div
                        className="text-blue-500 transition-transform"
                        style={{
                          transform: `rotate(${Math.min(
                            pullDistance * 2,
                            180
                          )}deg)`,
                        }}
                      >
                        ‚Üì
                      </div>
                    )}
                  </div>
                </div>
              )}

              {/* USER INDICATOR */}
              {view !== "pandaPoints" && (
                <div className="bg-white rounded-xl shadow-md p-3 mb-4 flex items-center justify-between">
                  <div className="flex items-center gap-2">
                    <div className="w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center font-semibold text-sm">
                      {user.charAt(0)}
                    </div>
                    <span className="text-sm text-gray-600">
                      <span className="font-semibold text-gray-800">
                        {user}
                      </span>
                    </span>
                  </div>
                  <button
                    onClick={() => {
                      localStorage.removeItem("currentUser");
                      setUser("");
                    }}
                    className="text-xs text-blue-600 hover:text-blue-700"
                  >
                    Wissel
                  </button>
                </div>
              )}

              {/* TRACKER VIEW */}
              {view === "tracker" && (
                <>
                  {/* HEADER */}
                  <div className="bg-white rounded-2xl shadow-lg p-6 mb-4">
                    <div className="flex justify-between items-start mb-2">
                      <div className="flex-1">
                        <h1 className="text-2xl font-bold text-gray-800">
                          Schone Zwaan
                        </h1>
                        <p className="text-gray-600">
                          Week {config.currentWeek} ‚Ä¢{" "}
                          {getWeekDateRange(config.currentWeek, currentYear)}
                        </p>
                        {config.currentWeek !== currentWeek && (
                          <div className="mt-2 text-xs bg-orange-100 text-orange-700 px-3 py-2 rounded flex items-center gap-2">
                            <span>
                              ‚ö†Ô∏è Week niet gesynchroniseerd (DB: week{" "}
                              {config.currentWeek}, Nu is week {currentWeek})
                            </span>
                            <button
                              onClick={async () => {
                                if (
                                  confirm(
                                    `Week corrigeren van ${config.currentWeek} naar ${currentWeek}?`
                                  )
                                ) {
                                  await db.ref("config").update({
                                    currentWeek: currentWeek,
                                    lastWeek: currentWeek - 1,
                                  });
                                  toast("Week gecorrigeerd!", "success");
                                }
                              }}
                              className="bg-orange-600 hover:bg-orange-700 text-white px-2 py-1 rounded text-xs font-semibold"
                            >
                              Herstel Week
                            </button>
                          </div>
                        )}
                      </div>
                      <div className="flex gap-2">
                        <button
                          onClick={() => {
                            setLoadingPandaZone(true);
                            setTimeout(() => {
                              setLoadingPandaZone(false);
                              setView("pandaPoints");
                            }, 2500);
                          }}
                          className="p-2 hover:bg-gray-100 rounded-lg transition-colors opacity-60 hover:opacity-100"
                          title="Panda Points"
                        >
                          <span className="text-xl">üêº</span>
                        </button>
                        <button
                          onClick={() => setView("leaderboard")}
                          className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                          title="Leaderboard"
                        >
                          <Icons.Trophy size={20} className="text-gray-600" />
                        </button>
                        <button
                          onClick={() => setView("activity")}
                          className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                          title="Activiteit"
                        >
                          <Icons.Activity size={20} className="text-gray-600" />
                        </button>
                        <button
                          onClick={() => setView("settings")}
                          className="p-2 hover:bg-gray-100 rounded-lg transition-colors"
                          title="Instellingen"
                        >
                          <Icons.Settings size={20} className="text-gray-600" />
                        </button>
                      </div>
                      {activity.status !== undefined && (
                        <div
                          className={`w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 ${
                            activity.status ? "bg-green-100" : "bg-gray-100"
                          }`}
                        >
                          {activity.status ? (
                            <Check size={14} className="text-green-600" />
                          ) : (
                            <X size={14} className="text-gray-400" />
                          )}
                        </div>
                      )}
                    </div>
                    <div className="mt-3 flex items-center gap-2">
                      <div className="flex-1 bg-gray-200 rounded-full h-2">
                        <div
                          className="bg-green-500 h-2 rounded-full transition-all"
                          style={{
                            width: `${
                              totalTasks > 0
                                ? (completedCount / totalTasks) * 100
                                : 0
                            }%`,
                          }}
                        />
                      </div>
                      <span className="text-sm font-medium text-gray-700">
                        {completedCount}/{totalTasks}
                      </span>
                    </div>
                  </div>

                  {/* Container with reduced spacing */}
                  <div className="space-y-2">
                    {/* DEADLINE BANNER */}
                    <div className="bg-white border-l-4 border-orange-500 rounded-xl shadow-sm p-2.5 flex items-center gap-2">
                      <div className="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0">
                        <Icons.Clock size={16} className="text-orange-600" />
                      </div>
                      <div className="flex-1">
                        <div className="text-sm font-semibold text-gray-900">
                          Deadline: Zondag{" "}
                          {(() => {
                            const sunday = new Date(now);
                            sunday.setDate(
                              now.getDate() + ((7 - now.getDay()) % 7)
                            );
                            return sunday.toLocaleDateString("nl-NL", {
                              day: "numeric",
                              month: "long",
                            });
                          })()}
                        </div>
                        <div className="text-xs text-gray-600">
                          {(() => {
                            const sunday = new Date(now);
                            sunday.setDate(
                              now.getDate() + ((7 - now.getDay()) % 7)
                            );
                            sunday.setHours(23, 59, 59, 999);
                            const diff = sunday - now;
                            const days = Math.floor(diff / 86400000);
                            const hours = Math.floor(
                              (diff % 86400000) / 3600000
                            );
                            if (days >= 2) return `${days} dagen`;
                            if (days === 1) return "1 dag";
                            if (hours > 0) return `${hours} uur`;
                            return "Bijna voorbij!";
                          })()}{" "}
                          resterend
                        </div>
                      </div>
                    </div>

                    {/* LAST WEEK BANNER */}
                    {config.lastWeek && currentWeek - config.lastWeek <= 1 && (
                      <div
                        onClick={() => setView("lastWeek")}
                        className="bg-white border-l-4 border-amber-500 rounded-xl shadow-sm p-2.5 flex items-center gap-2 cursor-pointer hover:bg-gray-50 transition-colors"
                      >
                        <div className="w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center flex-shrink-0">
                          <span className="text-base">üìÖ</span>
                        </div>
                        <div className="flex-1">
                          <div className="text-sm font-semibold text-gray-900">
                            Vorige Week (Week {config.lastWeek})
                          </div>
                          <div className="text-xs text-gray-600">
                            Klik om late taken af te vinken
                          </div>
                        </div>
                      </div>
                    )}

                    {/* DISHWASHER */}
                    <div className="bg-white border-l-4 border-green-500 rounded-xl shadow-sm p-3">
                      <div className="flex items-center justify-between mb-2">
                        <div className="flex items-center gap-2">
                          <div className="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0">
                            <span className="text-lg">üçΩÔ∏è</span>
                          </div>
                          <div>
                            <div className="text-sm font-semibold text-gray-900">
                              Vaatwasser
                            </div>
                            <div className="text-xs text-gray-600">
                              +{config.dishwasherPoints} punten
                            </div>
                          </div>
                        </div>
                        <div className="text-right">
                          <div className="text-xl font-bold text-green-700">
                            {(() => {
                              const weekCount = dishwasherLogs.filter(
                                (l) => l.weekNumber === config.currentWeek
                              ).length;
                              console.log("üìä Dishwasher count debug:", {
                                currentWeek: config.currentWeek,
                                actualWeek: currentWeek,
                                totalLogs: dishwasherLogs.length,
                                thisWeekLogs: weekCount,
                                allLogWeeks: dishwasherLogs.map(
                                  (l) => l.weekNumber
                                ),
                              });
                              return weekCount;
                            })()}
                            x
                          </div>
                          <div className="text-xs text-gray-600">deze week</div>
                        </div>
                      </div>
                      <button
                        onClick={() =>
                          canEmptyDishwasher() && setShowDishwasherConfirm(true)
                        }
                        disabled={!canEmptyDishwasher()}
                        className={`w-full p-2 rounded-lg text-xs font-semibold transition-all ${
                          canEmptyDishwasher()
                            ? "bg-blue-500 hover:bg-blue-600 text-white"
                            : "bg-gray-200 text-gray-500 cursor-not-allowed"
                        }`}
                      >
                        {canEmptyDishwasher()
                          ? "üçΩÔ∏è Vaatwasser geleegd?"
                          : "‚úì Al gedaan vandaag"}
                      </button>
                    </div>

                    {/* TASKS */}
                    <div className="bg-white rounded-xl shadow-sm p-3">
                      <h3 className="text-sm font-semibold text-gray-900 mb-2">
                        Taken
                      </h3>
                      <div className="space-y-1.5">
                        {config.tasks.map((task) => {
                          const isComplete = currentTasks[task.id];
                          const assignment = getAssignment(
                            task,
                            config.currentWeek
                          );
                          return (
                            <button
                              key={task.id}
                              onClick={() => toggleTask(task.id)}
                              className={`w-full p-2.5 rounded-xl shadow-sm transition-all ${
                                isComplete
                                  ? "bg-green-500 text-white"
                                  : "bg-white border border-gray-200 text-gray-800 hover:shadow-md"
                              }`}
                            >
                              <div className="flex items-center justify-between">
                                <div className="text-left">
                                  <div className="text-sm font-medium">
                                    {task.name}
                                  </div>
                                  <div className="flex items-center gap-2">
                                    <span
                                      className={`text-xs ${
                                        isComplete
                                          ? "text-green-100"
                                          : "text-gray-600"
                                      }`}
                                    >
                                      {assignment || "Niemand"}
                                    </span>
                                    <span
                                      className={`px-2.5 py-1 rounded-full text-xs font-medium ${
                                        isComplete
                                          ? "bg-green-200 text-green-800"
                                          : "bg-blue-100 text-blue-700"
                                      }`}
                                    >
                                      {task.points || 1.0} pt
                                    </span>
                                  </div>
                                </div>
                                <div
                                  className={`w-8 h-8 rounded-full flex items-center justify-center ${
                                    isComplete ? "bg-white" : "bg-gray-200"
                                  }`}
                                >
                                  {isComplete && (
                                    <Icons.Check
                                      size={20}
                                      className="text-green-500"
                                    />
                                  )}
                                </div>
                              </div>
                            </button>
                          );
                        })}
                      </div>
                    </div>
                  </div>
                </>
              )}

              {/* LAST WEEK VIEW */}
              {view === "lastWeek" && (
                <>
                  <div className="bg-white rounded-2xl shadow-lg p-6 mb-4">
                    <div className="flex items-center gap-3">
                      <button
                        onClick={() => setView("tracker")}
                        className="p-2 hover:bg-gray-100 rounded-lg"
                      >
                        <Icons.ChevronLeft size={20} />
                      </button>
                      <div>
                        <h1 className="text-2xl font-bold text-gray-800">
                          Week {config.lastWeek}
                        </h1>
                        <p className="text-gray-600">
                          {getWeekDateRange(config.lastWeek, currentYear)} ‚Ä¢ Te
                          laat = 50% punten
                        </p>
                      </div>
                    </div>
                  </div>

                  <div className="space-y-3">
                    {config.tasks.map((task) => {
                      const isComplete = lastTasks[task.id];
                      const assignment = getAssignment(task, config.lastWeek);
                      const canToggle = !isComplete && isEditable;
                      return (
                        <button
                          key={task.id}
                          onClick={() => canToggle && toggleTask(task.id, true)}
                          disabled={!canToggle}
                          className={`w-full p-5 rounded-xl shadow-md transition-all ${
                            isComplete
                              ? "bg-yellow-500 text-white cursor-not-allowed"
                              : canToggle
                              ? "bg-white text-gray-800 hover:shadow-lg"
                              : "bg-gray-200 text-gray-500 cursor-not-allowed"
                          }`}
                        >
                          <div className="flex items-center justify-between">
                            <div className="text-left">
                              <div className="font-semibold text-lg">
                                {task.name}
                              </div>
                              <div className="flex items-center gap-2">
                                <span
                                  className={`text-sm ${
                                    isComplete
                                      ? "text-yellow-100"
                                      : "text-gray-600"
                                  }`}
                                >
                                  {assignment || "Niemand"}{" "}
                                  {isComplete && "‚Ä¢ Te laat"}
                                </span>
                                <span
                                  className={`px-2 py-0.5 rounded-full text-xs font-medium ${
                                    isComplete
                                      ? "bg-yellow-200 text-yellow-800"
                                      : "bg-blue-100 text-blue-700"
                                  }`}
                                >
                                  {isComplete
                                    ? (task.points || 1.0) * 0.5
                                    : task.points || 1.0}{" "}
                                  pt
                                </span>
                              </div>
                            </div>
                            <div
                              className={`w-8 h-8 rounded-full flex items-center justify-center ${
                                isComplete ? "bg-white" : "bg-gray-200"
                              }`}
                            >
                              {isComplete && (
                                <Icons.Check
                                  size={20}
                                  className="text-yellow-500"
                                />
                              )}
                            </div>
                          </div>
                        </button>
                      );
                    })}
                  </div>
                </>
              )}

              {/* LEADERBOARD VIEW */}
              {view === "leaderboard" && (
                <>
                  <div className="bg-white rounded-2xl shadow-lg p-6">
                    <div className="flex items-center gap-3">
                      <button
                        onClick={() => setView("tracker")}
                        className="p-2 hover:bg-gray-100 rounded-lg"
                      >
                        <Icons.ChevronLeft size={20} />
                      </button>
                      <div>
                        <h1 className="text-2xl font-bold text-gray-800">
                          üèÜ Leaderboard
                        </h1>
                        <p className="text-gray-600">Wie is het schoonst?</p>
                      </div>
                    </div>
                  </div>

                  {(() => {
                    // Ensure all people are in leaderboard, even with 0 points
                    const fullLeaderboard = { ...leaderboard };
                    config.people.forEach((person) => {
                      if (!fullLeaderboard[person]) {
                        fullLeaderboard[person] = {
                          totalPoints: 0,
                          onTimePoints: 0,
                          latePoints: 0,
                          dishwasherPoints: 0,
                          dishwasherCount: 0,
                        };
                      }
                    });

                    const sorted = Object.entries(fullLeaderboard).sort(
                      ([, a], [, b]) =>
                        (b.totalPoints || 0) - (a.totalPoints || 0)
                    );

                    const top3 = sorted.slice(0, 3);
                    const rest = sorted.slice(3);

                    return (
                      <>
                        {/* PODIUM FOR TOP 3 */}
                        {top3.length > 0 && (
                          <div className="flex items-end justify-center gap-4 mb-8 mt-8">
                            {/* 2nd Place */}
                            {top3[1] && (
                              <div className="flex-1 text-center">
                                <div className="bg-gradient-to-br from-gray-200 to-gray-300 rounded-2xl p-6 shadow-lg transform translate-y-8">
                                  <div className="text-5xl mb-2">ü¶¢</div>
                                  <div className="text-4xl font-bold text-gray-700 mb-1">
                                    2
                                  </div>
                                  <div className="font-bold text-gray-800 text-lg mb-1">
                                    {top3[1][0]}
                                  </div>
                                  <div className="text-2xl font-bold text-gray-700">
                                    {top3[1][1].totalPoints.toFixed(1)}
                                  </div>
                                  <div className="text-xs text-gray-600">
                                    punten
                                  </div>
                                  <div className="text-xs text-gray-600 mt-1">
                                    üçΩÔ∏è {top3[1][1].dishwasherCount || 0}x
                                  </div>
                                </div>
                              </div>
                            )}

                            {/* 1st Place - SCHOONSTE ZWAAN */}
                            {top3[0] && (
                              <div className="flex-1 text-center">
                                <div className="bg-gradient-to-br from-yellow-300 via-yellow-400 to-yellow-500 rounded-2xl p-6 shadow-2xl relative">
                                  <div className="absolute -top-4 left-1/2 transform -translate-x-1/2 bg-yellow-500 text-white px-4 py-1 rounded-full text-sm font-bold shadow-lg">
                                    üëë Schoonste Zwaan
                                  </div>
                                  <div className="text-6xl mb-2 swan-bounce">
                                    ü¶¢
                                  </div>
                                  <div className="text-5xl font-bold text-yellow-900 mb-1">
                                    1
                                  </div>
                                  <div className="font-bold text-yellow-900 text-xl mb-1">
                                    {top3[0][0]}
                                  </div>
                                  <div className="text-3xl font-bold text-yellow-900">
                                    {top3[0][1].totalPoints.toFixed(1)}
                                  </div>
                                  <div className="text-sm text-yellow-800">
                                    punten
                                  </div>
                                  <div className="text-xs text-yellow-800 mt-1">
                                    üçΩÔ∏è {top3[0][1].dishwasherCount || 0}x
                                  </div>
                                </div>
                              </div>
                            )}

                            {/* 3rd Place */}
                            {top3[2] && (
                              <div className="flex-1 text-center">
                                <div className="bg-gradient-to-br from-orange-200 to-orange-300 rounded-2xl p-6 shadow-lg transform translate-y-12">
                                  <div className="text-4xl mb-2">ü¶¢</div>
                                  <div className="text-3xl font-bold text-orange-700 mb-1">
                                    3
                                  </div>
                                  <div className="font-bold text-orange-800 text-lg mb-1">
                                    {top3[2][0]}
                                  </div>
                                  <div className="text-xl font-bold text-orange-700">
                                    {top3[2][1].totalPoints.toFixed(1)}
                                  </div>
                                  <div className="text-xs text-orange-600">
                                    punten
                                  </div>
                                  <div className="text-xs text-orange-600 mt-1">
                                    üçΩÔ∏è {top3[2][1].dishwasherCount || 0}x
                                  </div>
                                </div>
                              </div>
                            )}
                          </div>
                        )}

                        {/* REST OF RANKINGS */}
                        {rest.length > 0 && (
                          <div className="space-y-3 mt-16">
                            {rest.map(([name, data], index) => {
                              const isLast = index === rest.length - 1;
                              return (
                                <div
                                  key={name}
                                  className={`rounded-xl p-5 shadow-md transition-all ${
                                    isLast
                                      ? "bg-gradient-to-r from-amber-50 to-orange-100 border-2 border-amber-300"
                                      : "bg-white"
                                  }`}
                                >
                                  <div className="flex items-center justify-between">
                                    <div className="flex items-center gap-4">
                                      <div className="text-4xl">üêï</div>
                                      <div>
                                        {isLast && (
                                          <div className="text-xs font-bold text-amber-700 mb-1">
                                            Vieze Daggoe
                                          </div>
                                        )}
                                        <div className="font-bold text-xl text-gray-800">
                                          {name}
                                        </div>
                                        <div className="text-sm text-gray-500">
                                          #{index + 4} ‚Ä¢ üçΩÔ∏è{" "}
                                          {data.dishwasherCount || 0}x
                                        </div>
                                      </div>
                                    </div>
                                    <div className="text-right">
                                      <div className="text-3xl font-bold text-gray-800">
                                        {data.totalPoints.toFixed(1)}
                                      </div>
                                      <div className="text-xs text-gray-500">
                                        punten
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              );
                            })}
                          </div>
                        )}

                        {/* INDIVIDUAL STATS CARD - Current User Only */}
                        {(() => {
                          const userData = fullLeaderboard[user];
                          if (!userData) return null;

                          return (
                            <div className="mt-8">
                              <h3 className="text-lg font-bold text-gray-800 mb-4">
                                üìä Mijn Punten
                              </h3>
                              <div className="bg-white rounded-xl shadow-md p-4">
                                <div className="grid grid-cols-3 gap-2">
                                  <div className="bg-green-50 rounded-lg p-2 text-center">
                                    <div className="text-xs text-green-600 font-medium mb-1">
                                      Op tijd
                                    </div>
                                    <div className="text-lg font-bold text-green-700">
                                      {(userData.onTimePoints || 0).toFixed(1)}
                                    </div>
                                  </div>

                                  <div className="bg-yellow-50 rounded-lg p-2 text-center">
                                    <div className="text-xs text-yellow-600 font-medium mb-1">
                                      Te laat
                                    </div>
                                    <div className="text-lg font-bold text-yellow-700">
                                      {(userData.latePoints || 0).toFixed(1)}
                                    </div>
                                  </div>

                                  <div className="bg-blue-50 rounded-lg p-2 text-center">
                                    <div className="text-xs text-blue-600 font-medium mb-1">
                                      üçΩÔ∏è Bonus
                                    </div>
                                    <div className="text-lg font-bold text-blue-700">
                                      {(userData.dishwasherPoints || 0).toFixed(
                                        1
                                      )}
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          );
                        })()}
                      </>
                    );
                  })()}
                </>
              )}

              {/* ACTIVITY VIEW */}
              {view === "activity" && (
                <>
                  <div className="bg-white rounded-2xl shadow-lg p-6 mb-4">
                    <div className="flex items-center gap-3">
                      <button
                        onClick={() => setView("tracker")}
                        className="p-2 hover:bg-gray-100 rounded-lg"
                      >
                        <Icons.ChevronLeft size={20} />
                      </button>
                      <div>
                        <h1 className="text-2xl font-bold text-gray-800">
                          üìä Activiteit
                        </h1>
                        <p className="text-gray-600">Recente acties</p>
                      </div>
                    </div>
                  </div>

                  <div className="space-y-2">
                    {activity.map((act, i) => (
                      <div
                        key={i}
                        className="bg-white rounded-xl shadow-md p-4"
                      >
                        <div className="flex items-start gap-3">
                          <div className="w-8 h-8 rounded-full bg-blue-100 text-blue-700 flex items-center justify-center font-semibold text-sm">
                            {act.user.charAt(0)}
                          </div>
                          <div className="flex-1">
                            <div className="text-sm">
                              <span className="font-semibold">{act.user}</span>
                              <span className="text-gray-600">
                                {" "}
                                {act.action}{" "}
                              </span>
                              <span className="font-medium">{act.task}</span>
                              <span className="text-gray-500">
                                {" "}
                                ‚Ä¢ Week {act.weekNumber}
                              </span>
                            </div>
                            <div className="text-xs text-gray-500 mt-1">
                              {formatTimestamp(act.timestamp)}
                            </div>
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>

                  {/* 1st Place - SCHOONSTE ZWAAN */}
                  {leaderboard[0] && (
                    <div className="flex-1 text-center">
                      <div className="bg-gradient-to-br from-yellow-300 via-yellow-400 to-yellow-500 rounded-2xl p-6 shadow-2xl relative">
                        <div className="absolute -top-4 left-1/2 transform -translate-x-1/2 bg-yellow-500 text-white px-4 py-1 rounded-full text-sm font-bold shadow-lg">
                          üëë Schoonste Zwaan
                        </div>
                        <div className="text-6xl mb-2 animate-bounce">ü¶¢</div>
                        <div className="text-5xl font-bold text-yellow-900 mb-1">
                          1
                        </div>
                        <div className="font-bold text-yellow-900 text-xl mb-1">
                          {leaderboard[0].name}
                        </div>
                        <div className="text-3xl font-bold text-yellow-900">
                          {leaderboard[0].points % 1 === 0
                            ? leaderboard[0].points
                            : leaderboard[0].points.toFixed(2)}
                        </div>
                        <div className="text-sm text-yellow-800">punten</div>
                        {leaderboard[0].currentStreak > 0 && (
                          <div className="mt-2 text-orange-600 font-bold text-sm">
                            üî• {leaderboard[0].currentStreak}{" "}
                            {leaderboard[0].currentStreak === 1
                              ? "week"
                              : "weken"}
                          </div>
                        )}
                      </div>
                    </div>
                  )}
                </>
              )}

              {/* SETTINGS VIEW */}
              {view === "settings" && (
                <SettingsView
                  config={config}
                  onBack={() => setView("tracker")}
                  currentWeek={config.currentWeek}
                  getAssignment={getAssignment}
                />
              )}

              {/* DISHWASHER CONFIRM */}
              <ConfirmDialog
                isOpen={showDishwasherConfirm}
                title="Is de vaat op het aanrecht ook ingeruimd?"
                message=""
                onConfirm={confirmDishwasher}
                onCancel={() => setShowDishwasherConfirm(false)}
                confirmText="Ja, bevestig"
                cancelText="Nee, annuleer"
              />
            </div>
          </div>
        );
      }

      // ============================================================================
      // SETTINGS VIEW
      // ============================================================================

      function SettingsView({ config, onBack, currentWeek, getAssignment }) {
        const [showAddPerson, setShowAddPerson] = useState(false);
        const [showAddTask, setShowAddTask] = useState(false);
        const [newPerson, setNewPerson] = useState("");
        const [newTask, setNewTask] = useState("");
        const [expandedTasks, setExpandedTasks] = useState({});

        const updateConfig = async (updates) => {
          await db.ref("config").update(updates);
        };

        const addPerson = async () => {
          if (!newPerson.trim() || config.people.includes(newPerson.trim()))
            return;
          await updateConfig({ people: [...config.people, newPerson.trim()] });
          setNewPerson("");
          setShowAddPerson(false);
        };

        const removePerson = async (person) => {
          const newTasks = config.tasks.map((t) => ({
            ...t,
            assignedPeople: t.assignedPeople.filter((p) => p !== person),
          }));
          await updateConfig({
            people: config.people.filter((p) => p !== person),
            tasks: newTasks,
          });
        };

        const addTask = async () => {
          if (!newTask.trim()) return;
          const id = newTask.toLowerCase().replace(/\s+/g, "_");
          await updateConfig({
            tasks: [
              ...config.tasks,
              { id, name: newTask.trim(), assignedPeople: [], points: 1.0 },
            ],
          });
          setNewTask("");
          setShowAddTask(false);
        };

        const removeTask = async (taskId) => {
          await updateConfig({
            tasks: config.tasks.filter((t) => t.id !== taskId),
          });
        };

        const updateTask = async (taskId, updates) => {
          const newTasks = config.tasks.map((t) =>
            t.id === taskId ? { ...t, ...updates } : t
          );
          await updateConfig({ tasks: newTasks });
        };

        const toggleTaskPerson = async (taskId, person) => {
          const task = config.tasks.find((t) => t.id === taskId);
          const assigned = task.assignedPeople.includes(person);
          const newAssigned = assigned
            ? task.assignedPeople.filter((p) => p !== person)
            : [...task.assignedPeople, person];
          await updateTask(taskId, { assignedPeople: newAssigned });
        };

        const changeRotation = async (taskId, person) => {
          const task = config.tasks.find((t) => t.id === taskId);
          const personIndex = task.assignedPeople.indexOf(person);
          const currentIndex = (currentWeek - 1) % task.assignedPeople.length;
          const newOffset = personIndex - currentIndex;
          await db.ref(`config/rotationOffsets/${taskId}`).set(newOffset);
        };

        return (
          <>
            <div className="bg-white rounded-2xl shadow-lg p-6 mb-4">
              <div className="flex items-center gap-3">
                <button
                  onClick={onBack}
                  className="p-2 hover:bg-gray-100 rounded-lg"
                >
                  <Icons.ChevronLeft size={20} />
                </button>
                <div>
                  <h1 className="text-2xl font-bold text-gray-800">
                    ‚öôÔ∏è Instellingen
                  </h1>
                  <p className="text-gray-600">Configuratie</p>
                </div>
              </div>
            </div>

            {/* PEOPLE */}
            <div className="bg-white rounded-xl shadow-md p-5 mb-4">
              <h3 className="font-semibold text-gray-700 mb-3">
                üë• Huisgenoten
              </h3>
              <div className="flex flex-wrap gap-2">
                {config.people.map((person) => (
                  <div
                    key={person}
                    className="inline-flex items-center gap-2 bg-blue-100 text-blue-700 px-4 py-2 rounded-full font-medium"
                  >
                    <span>{person}</span>
                    <button
                      onClick={() => removePerson(person)}
                      className="hover:bg-blue-200 rounded-full p-0.5"
                    >
                      <Icons.X size={16} />
                    </button>
                  </div>
                ))}
                {showAddPerson ? (
                  <div className="inline-flex items-center gap-2 bg-green-100 px-3 py-2 rounded-full">
                    <input
                      type="text"
                      value={newPerson}
                      onChange={(e) => setNewPerson(e.target.value)}
                      onKeyPress={(e) => e.key === "Enter" && addPerson()}
                      placeholder="Naam..."
                      className="bg-transparent border-none outline-none w-24 text-sm"
                      autoFocus
                    />
                    <button
                      onClick={addPerson}
                      className="hover:bg-green-200 rounded-full p-0.5"
                    >
                      <Icons.Check size={16} />
                    </button>
                    <button
                      onClick={() => setShowAddPerson(false)}
                      className="hover:bg-green-200 rounded-full p-0.5"
                    >
                      <Icons.X size={16} />
                    </button>
                  </div>
                ) : (
                  <button
                    onClick={() => setShowAddPerson(true)}
                    className="inline-flex items-center gap-1 bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-full font-medium"
                  >
                    <Icons.Plus size={16} />
                  </button>
                )}
              </div>
            </div>

            {/* ROTATION */}
            <div className="bg-white rounded-xl shadow-md p-5 mb-4">
              <h3 className="font-semibold text-gray-700 mb-3">
                üë§ Wie doet wat deze week?
              </h3>
              <div className="space-y-3">
                {config.tasks.map((task) => (
                  <div
                    key={task.id}
                    className="border border-gray-200 rounded-lg p-3"
                  >
                    <label className="block text-sm font-medium text-gray-700 mb-2">
                      {task.name}
                    </label>
                    <div className="flex flex-wrap gap-2">
                      {task.assignedPeople.map((person) => (
                        <button
                          key={person}
                          onClick={() => changeRotation(task.id, person)}
                          className={`px-4 py-2 rounded-lg border-2 transition-all ${
                            getAssignment(task, currentWeek) === person
                              ? "border-blue-500 bg-blue-50 text-blue-700 font-medium"
                              : "border-gray-200 hover:border-gray-300 text-gray-700"
                          }`}
                        >
                          {person}
                        </button>
                      ))}
                    </div>
                  </div>
                ))}
              </div>
            </div>

            {/* DISHWASHER POINTS */}
            <div className="bg-white rounded-xl shadow-md p-5 mb-4">
              <h3 className="font-semibold text-gray-700 mb-3">
                üçΩÔ∏è Vaatwasser Punten
              </h3>
              <div className="flex items-center gap-3">
                <input
                  type="number"
                  step="0.25"
                  min="0"
                  value={config.dishwasherPoints}
                  onChange={(e) =>
                    updateConfig({
                      dishwasherPoints: parseFloat(e.target.value) || 0.25,
                    })
                  }
                  className="w-32 px-4 py-2 border-2 border-gray-300 rounded-lg font-semibold"
                />
                <span className="text-gray-600">punten</span>
              </div>
            </div>

            {/* TASKS */}
            <div className="bg-white rounded-xl shadow-md p-5 mb-4">
              <h3 className="font-semibold text-gray-700 mb-3">üìã Taken</h3>
              <div className="space-y-3">
                {config.tasks.map((task) => (
                  <div
                    key={task.id}
                    className="border-2 border-gray-200 rounded-xl overflow-hidden"
                  >
                    <div
                      onClick={() =>
                        setExpandedTasks({
                          ...expandedTasks,
                          [task.id]: !expandedTasks[task.id],
                        })
                      }
                      className="flex items-center justify-between p-4 cursor-pointer hover:bg-gray-50"
                    >
                      <div className="flex items-center gap-3">
                        {expandedTasks[task.id] ? (
                          <Icons.ChevronDown size={20} />
                        ) : (
                          <Icons.ChevronRight size={20} />
                        )}
                        <span className="font-semibold">{task.name}</span>
                        <span className="text-xs text-gray-500">
                          ({task.points || 1.0} pt)
                        </span>
                      </div>
                      <button
                        onClick={(e) => {
                          e.stopPropagation();
                          removeTask(task.id);
                        }}
                        className="p-2 hover:bg-red-50 rounded-lg text-red-600"
                      >
                        <Icons.X size={18} />
                      </button>
                    </div>
                    {expandedTasks[task.id] && (
                      <div className="p-4 border-t bg-gray-50">
                        <label className="block text-sm font-medium text-gray-700 mb-2">
                          Punten
                        </label>
                        <input
                          type="number"
                          step="0.25"
                          min="0"
                          value={task.points || 1.0}
                          onChange={(e) =>
                            updateTask(task.id, {
                              points: parseFloat(e.target.value) || 1.0,
                            })
                          }
                          className="w-24 px-3 py-2 border border-gray-300 rounded-lg mb-3"
                        />
                        <p className="text-sm font-medium text-gray-700 mb-2">
                          Wie kan dit doen?
                        </p>
                        <div className="flex flex-wrap gap-2">
                          {config.people.map((person) => (
                            <button
                              key={person}
                              onClick={() => toggleTaskPerson(task.id, person)}
                              className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${
                                task.assignedPeople.includes(person)
                                  ? "bg-green-100 text-green-700 hover:bg-green-200"
                                  : "bg-gray-200 text-gray-700 hover:bg-gray-300"
                              }`}
                            >
                              {task.assignedPeople.includes(person)
                                ? "‚úì "
                                : "+ "}
                              {person}
                            </button>
                          ))}
                        </div>
                      </div>
                    )}
                  </div>
                ))}
                {showAddTask ? (
                  <div className="border-2 border-dashed border-green-300 rounded-xl p-4 bg-green-50">
                    <input
                      type="text"
                      value={newTask}
                      onChange={(e) => setNewTask(e.target.value)}
                      onKeyPress={(e) => e.key === "Enter" && addTask()}
                      placeholder="Taak naam..."
                      className="w-full px-3 py-2 border border-green-300 rounded-lg mb-2"
                      autoFocus
                    />
                    <div className="flex gap-2">
                      <button
                        onClick={addTask}
                        className="flex-1 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium"
                      >
                        Toevoegen
                      </button>
                      <button
                        onClick={() => setShowAddTask(false)}
                        className="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg font-medium"
                      >
                        Annuleer
                      </button>
                    </div>
                  </div>
                ) : (
                  <button
                    onClick={() => setShowAddTask(true)}
                    className="w-full border-2 border-dashed border-gray-300 hover:border-blue-400 hover:bg-blue-50 rounded-xl p-4 text-gray-600 hover:text-blue-600 font-medium flex items-center justify-center gap-2"
                  >
                    <Icons.Plus size={20} />
                    Nieuwe Taak
                  </button>
                )}
              </div>
            </div>
          </>
        );
      }

      // ============================================================================
      // INIT
      // ============================================================================

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
